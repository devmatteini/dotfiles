#!/usr/bin/env bash

sudo apt install -y gnome-shell-extension-manager
pipx install gnome-extensions-cli --system-site-packages

# Install extensions
gnome-extensions-cli install auto-move-windows@gnome-shell-extensions.gcampax.github.com
gnome-extensions-cli install clipboard-history@alexsaveau.dev
gnome-extensions-cli install just-perfection-desktop@just-perfection
gnome-extensions-cli install user-theme@gnome-shell-extensions.gcampax.github.com
gnome-extensions-cli install weatherornot@somepaulo.github.io
gnome-extensions-cli install window-title-is-back@fthx
gnome-extensions-cli install windowIsReady_Remover@nunofarruca@gmail.com
gnome-extensions-cli install tactile@lundal.io
gnome-extensions-cli install space-bar@luchrioh
gnome-extensions-cli install tophat@fflewddur.github.io

# Compile extensions schemas to be able to change their settings with gsettings
# - https://github.com/basecamp/omakub/blob/54c8a75cf9e93544a1d32fa4499b57b2840fee82/install/desktop/set-gnome-extensions.sh#L22
# - https://askubuntu.com/a/491224
for extension in ~/.local/share/gnome-shell/extensions/*; do
    schema=$(find "$extension/schemas" -type "f" -name "*.gschema.xml" | head -n 1 | xargs realpath)
    if [[ -z $schema ]]; then
        echo "No schema found for $extension. Skipped"
        continue
    fi
    sudo cp "$schema" /usr/share/glib-2.0/schemas/
done

sudo glib-compile-schemas /usr/share/glib-2.0/schemas/

# Auto move windows settings
gsettings set org.gnome.shell.extensions.auto-move-windows application-list "['code_code.desktop:1', 'spotify_spotify.desktop:3', 'com.discordapp.Discord.desktop:3', 'google-chrome.desktop:2', 'firefox.desktop:2', 'jetbrains-rustrover-433e2b6a-1f04-4e39-bda5-4d7f89462411.desktop:1', 'jetbrains-webstorm-65d18b0d-a561-47dd-92eb-3ded4468645f.desktop:1', 'chromium_chromium.desktop:2']"

# Clipboard History settings
gsettings set org.gnome.shell.extensions.clipboard-history paste-on-selection false
gsettings set org.gnome.shell.extensions.clipboard-history next-entry "['<Control>F12']"
gsettings set org.gnome.shell.extensions.clipboard-history prev-entry "['<Control>F11']"

# Weather or Not settings
gsettings set org.gnome.shell.extensions.weatherornot position 'left'

# Window title is back settings
gsettings set org.gnome.shell.extensions.window-title-is-back show-title false
gsettings set org.gnome.shell.extensions.window-title-is-back fixed-width false
gsettings set org.gnome.shell.extensions.window-title-is-back colored-icon true
gsettings set org.gnome.shell.extensions.window-title-is-back ease-time 0

# ubuntu dash-to-dock settings
gsettings set org.gnome.shell.extensions.dash-to-dock dock-fixed false
gsettings set org.gnome.shell.extensions.dash-to-dock dock-position 'LEFT'
gsettings set org.gnome.shell.extensions.dash-to-dock hotkeys-show-dock false
gsettings set org.gnome.shell.extensions.dash-to-dock show-trash false

# just perfection settings
gsettings set org.gnome.shell.extensions.just-perfection animation 4 # faster

# space bar settings
gsettings set org.gnome.shell.extensions.space-bar.appearance workspaces-bar-padding 10
gsettings set org.gnome.shell.extensions.space-bar.shortcuts enable-activate-workspace-shortcuts false
gsettings set org.gnome.shell.extensions.space-bar.shortcuts open-menu []
gsettings set org.gnome.shell.extensions.space-bar.shortcuts activate-previous-key []
gsettings set org.gnome.shell.extensions.space-bar.shortcuts activate-empty-key []

# top hat settings
gsettings set org.gnome.shell.extensions.tophat cpu-display 'numeric'
gsettings set org.gnome.shell.extensions.tophat mem-display 'numeric'
gsettings set org.gnome.shell.extensions.tophat show-disk false
gsettings set org.gnome.shell.extensions.tophat show-fs false
gsettings set org.gnome.shell.extensions.tophat show-net false
